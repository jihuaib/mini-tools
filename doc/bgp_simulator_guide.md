# BGP 模拟器使用指南

## 概述

BGP 模拟器是 Mini-Tools 中的一个核心工具，用于模拟 BGP（边界网关协议）的行为和路由传播过程。它可以帮助网络工程师和学习者理解 BGP 协议的工作原理，测试不同配置下的路由策略效果，以及诊断潜在的网络设计问题。

![BGP 模拟器界面](images/bgp_simulator.png)

## 功能特点

- **多 AS 支持**：模拟多个自治系统（AS）之间的 BGP 路由交换
- **对等体配置**：详细配置 BGP 对等体参数，包括 AS 号、邻居关系类型、IP 地址等
- **路由策略**：支持路由过滤、路由映射和属性修改
- **路由通告**：手动或批量添加路由并观察传播效果
- **可视化展示**：直观显示路由传播路径和决策过程

## 使用步骤

### 1. 基本配置

1. 在主界面选择 "BGP 模拟器" 工具
2. 在 BGP 配置区域，设置模拟器的基本参数：
    - 本地 AS 号
    - 路由器 ID
    - 基本定时器参数

### 2. 添加 BGP 对等体

1. 点击 "添加对等体" 按钮
2. 在弹出的表单中填写以下信息：
    - 对等体名称（用于识别）
    - 对等体 AS 号
    - 对等体 IP 地址
    - 连接类型（IBGP/EBGP）
    - 邻居关系描述（可选）
3. 点击确认保存对等体信息

### 3. 配置路由策略

1. 在 "路由策略" 标签页中添加策略规则
2. 支持的策略类型：
    - **路由过滤**：基于前缀、AS 路径等条件过滤路由
    - **属性修改**：修改 Local Preference, MED, AS Path 等属性
    - **路由重分发**：在不同路由协议间重分发路由

### 4. 添加路由

1. 在 "路由配置" 标签页中添加需要通告的路由
2. 设置路由属性：
    - 网络前缀和掩码
    - 下一跳地址
    - 路由起源
    - BGP 社区
    - 其他属性

### 5. 启动模拟

1. 点击 "启动模拟" 按钮
2. 观察路由表的变化和路由决策过程
3. 模拟器将展示每个 AS 的最佳路由选择

### 6. 分析结果

1. 查看各 BGP 对等体接收到的路由
2. 分析最佳路径选择过程
3. 检查路由策略的效果
4. 调整配置以优化路由传播

## 高级功能

### 路由抖动模拟

1. 在高级设置中开启路由抖动模拟
2. 设置抖动参数：频率、持续时间
3. 观察网络在路由不稳定状态下的表现

### BGP 社区配置

1. 添加和管理 BGP 社区属性
2. 配置基于社区的路由策略
3. 观察社区属性对路由决策的影响

### 故障注入

1. 使用故障注入功能模拟链路中断或 BGP 会话重置
2. 分析网络收敛时间和故障恢复过程
3. 测试网络冗余设计的有效性

## 实际应用场景

- **网络设计验证**：在实际部署前验证 BGP 设计
- **故障排除训练**：模拟各种 BGP 问题进行故障排除训练
- **教育演示**：作为教学工具演示 BGP 工作原理
- **路由优化**：测试不同路由策略的效果，优化网络性能

## 提示与技巧

- 从简单拓扑开始，逐步增加复杂性
- 使用有意义的命名约定以便于识别不同组件
- 保存常用配置场景以便重复使用
- 比较不同路由策略的结果以理解 BGP 决策过程
- 结合实际网络拓扑图使用模拟器可以提高理解效果

## 故障排除

- **模拟器无法启动**：检查 AS 号和 Router ID 是否有效
- **路由未正确传播**：检查对等体配置和路由策略设置
- **界面卡顿**：减少同时模拟的 AS 数量或路由数量
- **数据不一致**：点击"重置模拟"按钮重新开始模拟
