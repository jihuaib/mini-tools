const BMP_HEADER_LENGTH = 6;

const BMP_INITIATION_TLV_TYPE = {
    SYS_NAME: 1,
    SYS_DESC: 2
};

// BMP peer types
const BMP_PEER_TYPE = {
    GLOBAL: 0,
    L3VPN: 1,
    LOCAL: 2,
    LOCAL_RIB: 3
};

const BMP_SESSION_FLAGS = {
    IPV6: 0x80, // V 位: 使用 IPv6 地址
    POST_POLICY: 0x40, // P 位: Adj-RIB-In 是策略后导出的（post-policy）
    AS_PATH: 0x20, // L 位: 表示 AS_PATH
    ADJ_RIB_OUT: 0x10 // O 位: Adj-RIB-Out
};

const BMP_SESSION_STATE = {
    PEER_UP: 0,
    PEER_DOWN: 1
};

const BMP_ROUTE_UPDATE_TYPE = {
    ROUTE_DELETE: 0,
    ROUTE_UPDATE: 1
};

// BMP message types (RFC 7854)
const BMP_MSG_TYPE = {
    ROUTE_MONITORING: 0,
    STATISTICS_REPORT: 1,
    PEER_DOWN_NOTIFICATION: 2,
    PEER_UP_NOTIFICATION: 3,
    INITIATION: 4,
    TERMINATION: 5,
    ROUTE_MIRRORING: 6
};

const BMP_MSG_TYPE_NAME = {
    [BMP_MSG_TYPE.ROUTE_MONITORING]: 'ROUTE_MONITORING',
    [BMP_MSG_TYPE.STATISTICS_REPORT]: 'STATISTICS_REPORT',
    [BMP_MSG_TYPE.PEER_DOWN_NOTIFICATION]: 'PEER_DOWN_NOTIFICATION',
    [BMP_MSG_TYPE.PEER_UP_NOTIFICATION]: 'PEER_UP_NOTIFICATION',
    [BMP_MSG_TYPE.INITIATION]: 'INITIATION',
    [BMP_MSG_TYPE.TERMINATION]: 'TERMINATION',
    [BMP_MSG_TYPE.ROUTE_MIRRORING]: 'ROUTE_MIRRORING'
};

// 事件类型
const BMP_EVT_TYPES = {
    INITIATION: 1,
    SESSION_UPDATE: 2,
    ROUTE_UPDATE: 3,
    TERMINATION: 4,
    INSTANCE_UPDATE: 5,
    INSTANCE_ROUTE_UPDATE: 6,
    STATISTICS_REPORT: 7
};

// BMP请求-响应类型
const BMP_REQ_TYPES = {
    START_BMP: 1,
    STOP_BMP: 2,
    GET_CLIENT_LIST: 3,
    GET_BGP_SESSIONS: 4,
    GET_BGP_ROUTES: 5,
    GET_BGP_INSTANCES: 6,
    GET_BGP_INSTANCE_ROUTES: 7
};

const BMP_BGP_RIB_TYPE = {
    PRE_ADJ_RIB_IN: 1,
    ADJ_RIB_IN: 2,
    AS_PATH: 3,
    ADJ_RIB_OUT: 4,
    POST_ADJ_RIB_OUT: 5
};

// BMP Statistics Types (RFC 7854 Section 4.8)
const BMP_STATS_TYPE = {
    NUM_PREFIXES_REJECTED: 0,
    NUM_DUPLICATE_PREFIX_ADVERTISEMENTS: 1,
    NUM_DUPLICATE_WITHDRAWS: 2,
    NUM_UPDATES_INVALIDATED_CLUSTER_LIST: 3,
    NUM_UPDATES_INVALIDATED_AS_PATH_LOOP: 4,
    NUM_UPDATES_INVALIDATED_ORIGINATOR_ID: 5,
    NUM_UPDATES_INVALIDATED_AS_CONFED_LOOP: 6,
    NUM_ADJ_RIB_IN: 7,
    NUM_LOC_RIB: 8,
    NUM_UPDATES_TREATED_AS_WITHDRAW: 9,
    NUM_PREFIXES_TREATED_AS_WITHDRAW: 10,
    NUM_DUPLICATE_UPDATE_MESSAGES: 11
};

const BMP_STATS_TYPE_NAME = {
    [BMP_STATS_TYPE.NUM_PREFIXES_REJECTED]: '拒绝的前缀数',
    [BMP_STATS_TYPE.NUM_DUPLICATE_PREFIX_ADVERTISEMENTS]: '重复的前缀通告数',
    [BMP_STATS_TYPE.NUM_DUPLICATE_WITHDRAWS]: '重复的撤销数',
    [BMP_STATS_TYPE.NUM_UPDATES_INVALIDATED_CLUSTER_LIST]: '因 Cluster List 无效的更新数',
    [BMP_STATS_TYPE.NUM_UPDATES_INVALIDATED_AS_PATH_LOOP]: '因 AS Path 环路无效的更新数',
    [BMP_STATS_TYPE.NUM_UPDATES_INVALIDATED_ORIGINATOR_ID]: '因 Originator ID 无效的更新数',
    [BMP_STATS_TYPE.NUM_UPDATES_INVALIDATED_AS_CONFED_LOOP]: '因 AS Confed 环路无效的更新数',
    [BMP_STATS_TYPE.NUM_ADJ_RIB_IN]: 'Adj-RIB-In 中的路由数',
    [BMP_STATS_TYPE.NUM_LOC_RIB]: 'Loc-RIB 中的路由数',
    [BMP_STATS_TYPE.NUM_UPDATES_TREATED_AS_WITHDRAW]: '被视为撤销的更新数',
    [BMP_STATS_TYPE.NUM_PREFIXES_TREATED_AS_WITHDRAW]: '被视为撤销的前缀数',
    [BMP_STATS_TYPE.NUM_DUPLICATE_UPDATE_MESSAGES]: '重复的更新消息数'
};

module.exports = {
    BMP_HEADER_LENGTH,
    BMP_MSG_TYPE,
    BMP_PEER_TYPE,
    BMP_SESSION_FLAGS,
    BMP_MSG_TYPE_NAME,
    BMP_INITIATION_TLV_TYPE,
    BMP_SESSION_STATE,
    BMP_ROUTE_UPDATE_TYPE,
    BMP_EVT_TYPES,
    BMP_REQ_TYPES,
    BMP_BGP_RIB_TYPE,
    BMP_STATS_TYPE,
    BMP_STATS_TYPE_NAME
};
